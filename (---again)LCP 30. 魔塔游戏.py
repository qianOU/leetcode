class Solution:
    # 贪心
    #堆 记录已走过的负数
    def magicTower(self, nums) -> int:
        if sum(nums) < 0: return -1
        import heapq
        heap = []
        cum =  1
        ans =  0 
        visited = set()
        for r in range(len(nums)):
            cum += nums[r] 
            if nums[r] < 0: heapq.heappush(heap, nums[r])
            if cum <= 0: # 如果当前已经死亡，去掉最大的负数
                cum -= heapq.heappop(heap)
                ans += 1
        return ans 

class Solution:
    # 错误代码：
    def magicTower(self, nums) -> int:
        if sum(nums) < 0: return -1
        import heapq
        heap = []
        cum =  1
        ans =  0 
        for r in range(len(nums)):
            while heap and cum + nums[r] <= 0:  # 错误原因！！！如果nums[r] 十分小，就会造成多词弹出heap，nums[r] 应该也是选择之一
                cum -= heapq.heappop(heap)
                ans += 1
            if nums[r] < 0: 
                heapq.heappush(heap, nums[r])
            cum += nums[r]
   
        
        return ans 

print(Solution().magicTower(
[-1,-1,10]

# [100,100,100,-250,-60,-140,-50,-50,100,150]
# [-10715,70330,-86814,47156,-30228,43981,33837,18381,6608]
# [-63609,38525,-21431,-67223,-27996,38838,59899,5726,-28966,-51323,4180,89176,-67724,84530,94179,16075,-83960,-43738,1207,-82978,35765,-29814,18571,56514,-70204,-36828,-33349,34436,-22216,-88629,5173,-15285,12012,66917,86922,-82731,-88012,66556,62999,-56221,-57725,76698,-41293,70570,16519,-58519,-77725,-6162,76844,-86418,-41564,8130,-16669,74314,42723,52556,3632,97737,61998,-7353,49468,21381,-41367,-44560,80195,29272,-15048,-8252,84394,-49155,-92031,-78343,-53886,95425,-99913,-41429,-87834,-12072,53466,7413,21160,97315,5386,-3529,-44705,-11953,-65582,-32381,96170,12627,-53601,10895,-49012,-59402,92298,-62265,-53256,46650,-31361,69169,98734,23691,93027,45521,-42167,-16398,-37764,-41746,79903,-66659,50941,-54170,86485,65021,-95613,56530,-12743,85273,52730,32628,-79894,-38535,95028,-57407,81445,44600,-19016,7375,20485,36507,59666,44516,-86481,1464,85584,22374,78925,69320,-11250,-80182,-79157,24820,7519,-73403,9049,-17122,4646,-62209,-8688,68283,24970,43808,-19017,-73319,-60772,46110,-54326,-16712,16134,-52625,47084,-47337,-41349,87822,-79195,79361,-44187,-46742,36235,-9296,10625,33396,34547,61078,-9482,38264,24921,29570,46413,-67810,53117,-77714,21144,85319,86218,47655,-22267,-54786,78805,42289,94637,-79383,-94187,17514,-62338,-88486,43436,-50037,6168,73733,-7035,-17606,-12649,48094,13624,-94182,-17338,-38032,-33366,-33026,-46084,-20270,35676,77737,13698,98195,-9599,14927,33485,14112,75536,-6663,-38086,51802,-57321,45198,-54347,7312,70043,-998,97022,-80534,-67810,-28030,-16423,20516,-75596,44065,14173,76300,1364,34235,51059,-72358,66372,34413,-72180,45971,67557,-65914,-10898,-4037,67646,-14509,-13988,98509,66911,-12946,98486,-42949,44614,-68110,-71398,52748,59682,-42025,17515,-40223,-46835,72531,12575,-26884,72245,-32480,58804,69060,24302,-58280,-67128,-45542,-14887,-99035,-74020,92015,-42753,-45005,-98670,-70830,23564,98212,86586,1059,-94873,-4023,76270,73543,8886,66852,-87252,-84195,-77471,66570,-72112,-56295,-17674,71223,23862,71707,-12280,44231,78365,-6373,-65188,3012,90919,51099,-2774,38297,56339,-76109,-63571,-67170,58744,47695,-90427,62787,-25739,79025,-5119,-61335,55813,48137,61861,-65102,24525,5100,-52326,-18671,-69053,-91174,-54620,36581,-40576,-98602,180,-37535,90294,-35506,-5250,-3182,-41529,21789,92846,-87477,-79262,1366,47966,-57276,-80043,-45359,96007,-44680,-7197,-6463,27100,54754,-46223,-66431,81067,-5439,-71571,53967,40641,20165,65516,-78689,34528,-43968,-69405,39810,-5029,-73515,17707,90047,43996,-25158,10108,-30315,13536,-89707,-43004,-98551,15521,46538,71777,-12262,-7160,-65692,55136,12878,98780,-7386,94757,70072,-58056,-38957,-42435,35805,83652,-55653,93481,-64187,49688,-95152,-98513,-13,45304,-57102,-37078,19619,-28236,-17437,-25684,-15387,48779,85779,-61304,-32493,35089,-25487,82236,-98172,82509,-24895,21174,21984,-84327,66085,45428,-50779,82522,72302,-67325,-12121,20734,-76703,-39501,16555,17812,-79341,-20829,-17199,40130,-64121,-14725,32036,82941,49557,84156,-12235,-16391,-58241,54677,-17758,17511,-58576,74734,13988,12945,-25436,99610,-24483,16583,42235,-45272,23188,-6311,-30834,-37237,-10805,27232,53956,-80913,16946,-89656,68633,99726,96104,91797,52473,-47941,-26685,-40524,-27803,-95039,81808,63308,-89123,14746,-58820,38287,6265,75822,10199,83301,-2305,-43137,-43583,26053,-61760,4280,94173,101,69875,34288,69752,-99072,76339,426,-74838,87739,-36574,-53402,-28349,77534,-3839,77763,7282,63629,66933,-72141,-84187,-83682,-91406,84424,-38258,-89724,-29147,-27756,78357,-30888,33472,-14285,42990,61503,61618,-8678,-64717,-42678,-47353,72465,8134,-21682,-65304,73968,7475,-63679,-24794,-92641,-64179,-76397,48499,53451,-34987,10279,63858,-30939,27790,9666,76988,96737,-49016,60789,78774,20249,51156,-26197,65249,-34353,66074,4359,76697,-22595,-26449,-97525,-66062,-883,52262,74841,17315,11494,47381,-25382,4623,17264,-27625,-97179,43743,77945,-57299,-52103,50813,-8197,17151,-99235,-79762,72891,8581,33571,-59027,16339,-28350,24046,19882,63896,47127,71980,57893,34641,25229,-53707,93453,-24317,96763,-87191,-96771,71753,-36246,58363,10026,-24041,99342,13036,21471,-35665,90749,-20069,99050,74719,69205,56316,-18464,68076,-54104,83536,-13612,72940,-6409,90306,37148,-54951,62980,-76938,52680,91471,-41569,-8646,-88715,48685,-35820,-86683,15908,50275,67252,-4582,16247,-5048,97979,75710,-41833,40390,12950,95336,-74066,-98887,-18226,-2920,-13681,62037,-41836,95893,36987,-11419,-27042,97620,-46945,-69643,66033,-65469,26047,94765,-26062,-43991,-56855,39248,-6460,93783,57159,31022,-1576,96867,-63901,-74365,54926,13674,17823,61464,60273,49106,-84018,-83321,-42388,-40926,95407,-32061,-97129,-5516,-6741,46331,62640,29437,-51607,-14442,99793,-68789,-65950,27211,5963,-35151,27274,69390,-49853,-77283,-11371,-70933,-68689,-96352,41786,77272,-40550,-5498,-88259,-77556,39788,-9944,-8875,65553,-24281,-84300,42928,34273,67192,-93915,82780,1622,82693,39095,30775,-20147,-81479,-47040,78699,30985,-87863,48945,8830,-48481,-40757,92687,42576,34827,78460,90560,4668,53872,24315,-40501,-52374,57596,18085,-98503,-51673,8946,24123,83452,5916,42959,-36128,14571,-96511,-28780,-89395,44014,-34228,43865,20268,-27816,20228,-23065,75265,-55076,-95675,61418,-65879,-21833,47034,-10272,-43510,67533,-76108,-27663,28582,15133,-2427,-89995,-77578,-64100,23507,22278,86435,-65989,62130,97059,84270,54154,37375,40990,-48245,-92643,-24836,54805,81319,85781,75124,-20076,-87776,-37307,82251,-65027,77246,-82470,2175,-95693,-40587,-48031,-1335,1073,5429,73405,-67772,4026,-86193,-82967,-30360,38965,-75449,-88581,61982,75247,11285,92046,78850,-38715,-20565,67640,-58493,42868,87264,47562,-73441,66862,33074,39043,65562,943,-83754,3539,13368,-59455,32616,71582,-74690,15107,16967,56823,9305,-85496,84169,83819,-7158,78372,4574,-55859,16655,59253,-13980,-52930,11881,-94395,58401,-70129,34849,-57836,25191,-2529,63049,96699,31349,72686,-4317,10808,-58083,-97436,-37735,-21434,-46744,44495,-70999,-30720,63525,65821,-72855,3003,-37135,-23328,-64601,75769,-10449,55102,-37116,81101,73193,-62947,-63993,-57014,-6859,74870,97044,87531,-49168,18479,86128,18819,47395,15211,49087,3764,88477,-595,60513,52370,95663,-70229,70124,-88619,-66171,-45527,61788,-72367,77244,-17120,-65375,92672,-48812,4649,44839,-99858,-86795,-64840,-86092,-63651,97524,-72475,58795,-39416,90733,6655,1414,-73883,47437,-65815]
# [-63609,38525,-21431,-67223,-27996,38838,59899,5726,-28966,-51323,4180,89176,-67724,84530,94179,16075,-83960,-43738,1207,-82978,35765,-29814,18571,56514,-70204,-36828,-33349,34436,-22216,-88629,5173,-15285,12012,66917,86922,-82731,-88012,66556,62999,-56221,-57725,76698,-41293,70570,16519,-58519,-77725,-6162,76844,-86418,-41564,8130,-16669,74314,42723,52556,3632,97737,61998,-7353,49468,21381,-41367,-44560,80195,29272,-15048,-8252,84394,-49155,-92031,-78343,-53886,95425,-99913,-41429,-87834,-12072,53466,7413,21160,97315,5386,-3529,-44705,-11953,-65582,-32381,96170,12627,-53601,10895,-49012,-59402,92298,-62265,-53256,46650,-31361,69169,98734,23691,93027,45521,-42167,-16398,-37764,-41746,79903,-66659,50941,-54170,86485,65021,-95613,56530,-12743,85273,52730,32628,-79894,-38535,95028,-57407,81445,44600,-19016,7375,20485,36507,59666,44516,-86481,1464,85584,22374,78925,69320,-11250,-80182,-79157,24820,7519,-73403,9049,-17122,4646,-62209,-8688,68283,24970,43808,-19017,-73319,-60772,46110,-54326,-16712,16134,-52625,47084,-47337,-41349,87822,-79195,79361,-44187,-46742,36235,-9296,10625,33396,34547,61078,-9482,38264,24921,29570,46413,-67810,53117,-77714,21144,85319,86218,47655,-22267,-54786,78805,42289,94637,-79383,-94187,17514,-62338,-88486,43436,-50037,6168,73733,-7035,-17606,-12649,48094,13624,-94182,-17338,-38032,-33366,-33026,-46084,-20270,35676,77737,13698,98195,-9599,14927,33485,14112,75536,-6663,-38086,51802,-57321,45198,-54347,7312,70043,-998,97022,-80534,-67810,-28030,-16423,20516,-75596,44065,14173,76300,1364,34235,51059,-72358,66372,34413,-72180,45971,67557,-65914,-10898,-4037,67646,-14509,-13988,98509,66911,-12946,98486,-42949,44614,-68110,-71398,52748,59682,-42025,17515,-40223,-46835,72531,12575,-26884,72245,-32480,58804,69060,24302,-58280,-67128,-45542,-14887,-99035,-74020,92015,-42753,-45005,-98670,-70830,23564,98212,86586,1059,-94873,-4023,76270,73543,8886,66852,-87252,-84195,-77471,66570,-72112,-56295,-17674,71223,23862,71707,-12280,44231,78365,-6373,-65188,3012,90919,51099,-2774,38297,56339,-76109,-63571,-67170,58744,47695,-90427,62787,-25739,79025,-5119,-61335,55813,48137,61861,-65102,24525,5100,-52326,-18671,-69053,-91174,-54620,36581,-40576,-98602,180,-37535,90294,-35506,-5250,-3182,-41529,21789,92846,-87477,-79262,1366,47966,-57276,-80043,-45359,96007,-44680,-7197,-6463,27100,54754,-46223,-66431,81067,-5439,-71571,53967,40641,20165,65516,-78689,34528,-43968,-69405,39810,-5029,-73515,17707,90047,43996,-25158,10108,-30315,13536,-89707,-43004,-98551,15521,46538,71777,-12262,-7160,-65692,55136,12878,98780,-7386,94757,70072,-58056,-38957,-42435,35805,83652,-55653,93481,-64187,49688,-95152,-98513,-13,45304,-57102,-37078,19619,-28236,-17437,-25684,-15387,48779,85779,-61304,-32493,35089,-25487,82236,-98172,82509,-24895,21174,21984,-84327,66085,45428,-50779,82522,72302,-67325,-12121,20734,-76703,-39501,16555,17812,-79341,-20829,-17199,40130,-64121,-14725,32036,82941,49557,84156,-12235,-16391,-58241,54677,-17758,17511,-58576,74734,13988,12945,-25436,99610,-24483,16583,42235,-45272,23188,-6311,-30834,-37237,-10805,27232,53956,-80913,16946,-89656,68633,99726,96104,91797,52473,-47941,-26685,-40524,-27803,-95039,81808,63308,-89123,14746,-58820,38287,6265,75822,10199,83301,-2305,-43137,-43583,26053,-61760,4280,94173,101,69875,34288,69752,-99072,76339,426,-74838,87739,-36574,-53402,-28349,77534,-3839,77763,7282,63629,66933,-72141,-84187,-83682,-91406,84424,-38258,-89724,-29147,-27756,78357,-30888,33472,-14285,42990,61503,61618,-8678,-64717,-42678,-47353,72465,8134,-21682,-65304,73968,7475,-63679,-24794,-92641,-64179,-76397,48499,53451,-34987,10279,63858,-30939,27790,9666,76988,96737,-49016,60789,78774,20249,51156,-26197,65249,-34353,66074,4359,76697,-22595,-26449,-97525,-66062,-883,52262,74841,17315,11494,47381,-25382,4623,17264,-27625,-97179,43743,77945,-57299,-52103,50813,-8197,17151,-99235,-79762,72891,8581,33571,-59027,16339,-28350,24046,19882,63896,47127,71980,57893,34641,25229,-53707,93453,-24317,96763,-87191,-96771,71753,-36246,58363,10026,-24041,99342,13036,21471,-35665,90749,-20069,99050,74719,69205,56316,-18464,68076,-54104,83536,-13612,72940,-6409,90306,37148,-54951,62980,-76938,52680,91471,-41569,-8646,-88715,48685,-35820,-86683,15908,50275,67252,-4582,16247,-5048,97979,75710,-41833,40390,12950,95336,-74066,-98887,-18226,-2920,-13681,62037,-41836,95893,36987,-11419,-27042,97620,-46945,-69643,66033,-65469,26047,94765,-26062,-43991,-56855,39248,-6460,93783,57159,31022,-1576,96867,-63901,-74365,54926,13674,17823,61464,60273,49106,-84018,-83321,-42388,-40926,95407,-32061,-97129,-5516,-6741,46331,62640,29437,-51607,-14442,99793,-68789,-65950,27211,5963,-35151,27274,69390,-49853,-77283,-11371,-70933,-68689,-96352,41786,77272,-40550,-5498,-88259,-77556,39788,-9944,-8875,65553,-24281,-84300,42928,34273,67192,-93915,82780,1622,82693,39095,30775,-20147,-81479,-47040,78699,30985,-87863,48945,8830,-48481,-40757,92687,42576,34827,78460,90560,4668,53872,24315,-40501,-52374,57596,18085,-98503,-51673,8946,24123,83452,5916,42959,-36128,14571,-96511,-28780,-89395,44014,-34228,43865,20268,-27816,20228,-23065,75265,-55076,-95675,61418,-65879,-21833,47034,-10272,-43510,67533,-76108,-27663,28582,15133,-2427,-89995,-77578,-64100,23507,22278,86435,-65989,62130,97059,84270,54154,37375,40990,-48245,-92643,-24836,54805,81319,85781,75124,-20076,-87776,-37307,82251,-65027,77246,-82470,2175,-95693,-40587,-48031,-1335,1073,5429,73405,-67772,4026,-86193,-82967,-30360,38965,-75449,-88581,61982,75247,11285,92046,78850,-38715,-20565,67640,-58493,42868,87264,47562,-73441,66862,33074,39043,65562,943,-83754,3539,13368,-59455,32616,71582,-74690,15107,16967,56823,9305,-85496,84169,83819,-7158,78372,4574,-55859,16655,59253,-13980,-52930,11881,-94395,58401,-70129,34849,-57836,25191,-2529,63049,96699,31349,72686,-4317,10808,-58083,-97436,-37735,-21434,-46744,44495,-70999,-30720,63525,65821,-72855,3003,-37135,-23328,-64601,75769,-10449,55102,-37116,81101,73193,-62947,-63993,-57014,-6859,74870,97044,87531,-49168,18479,86128,18819,47395,15211,49087,3764,88477,-595,60513,52370,95663,-70229,70124,-88619,-66171,-45527,61788,-72367,77244,-17120,-65375,92672,-48812,4649,44839,-99858,-86795,-64840,-86092,-63651,97524,-72475,58795,-39416,90733,6655,1414,-73883,47437,-65815]
))